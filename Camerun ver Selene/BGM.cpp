//*============================================================================
//BGM.cpp
//*============================================================================

//=============================================================================
//include
//=============================================================================
#include "BGM.h"

//=============================================================================
//コンストラクタ
//=============================================================================
//[input]
//	name:データ名
//=============================================================================
CBGM::CBGM( std::string name ) :m_pBGM(NULL)
{
	m_DataName = name;
}


//=============================================================================
//デストラクタ
//=============================================================================
CBGM::~CBGM(void)
{
	SAFE_RELEASE( m_pBGM );
}

//=============================================================================
//サウンドの読み込み
//=============================================================================
//[input]
//	pCore:コアデバイス
//=============================================================================
void CBGM::LoadSound( ICore *pCore )
{
	if( !m_DataName.empty() )
	{	
		m_pBGM = pCore->CreateStreamSoundFromFile( m_DataName.c_str(), false, "OggVorbis" );
	}
	
}

//=============================================================================
//処理
//=============================================================================
void CBGM::Exec()
{
	m_pBGM->Play(-1);
}

//=============================================================================
//フェードアウト
//=============================================================================
void CBGM::FadeOut()
{
	static int count = 0;
	
	while( count <= 60 )
	{
	
		float fVolume = Interpolation::Flat( 100.0f, 0.0f, 60, count );
		
		m_pBGM->SetVolume( fVolume );
		
		count++;
		
	
	}
	
	if( count >= 60 )
	{
		count = 0;
	}

	
}





